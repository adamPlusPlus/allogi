import{useState as I,useEffect as te,useCallback as ve,useMemo as ye,useRef as ke}from"react";import ge,{useEffect as fe,useRef as be}from"react";import{jsx as $,jsxs as Q}from"react/jsx-runtime";function B({isVisible:w,x:S,y:j,items:h,onClose:k}){let C=be(null);return fe(()=>{let m=c=>{C.current&&!C.current.contains(c.target)&&k()};if(w)return document.addEventListener("mousedown",m),()=>document.removeEventListener("mousedown",m)},[w,k]),w?$("div",{ref:C,className:"context-menu",style:{left:S,top:j,position:"fixed",zIndex:1e3},onClick:m=>m.stopPropagation(),children:h.map((m,c)=>$(ge.Fragment,{children:m.separator?$("div",{className:"context-menu-separator"}):Q("div",{className:`context-menu-item ${m.disabled?"disabled":""} ${m.submenu?"context-menu-item-submenu":""}`,onClick:()=>{m.disabled||(m.action(),k())},children:[m.icon&&$("span",{className:"context-menu-icon",children:m.icon}),$("span",{className:"context-menu-label",children:m.label}),m.submenu&&$("span",{className:"context-menu-arrow",children:"\u25B6"}),m.submenu&&$("div",{className:"context-submenu",children:m.submenu.map((p,x)=>Q("div",{className:`context-menu-item ${p.disabled?"disabled":""}`,onClick:f=>{f.stopPropagation(),p.disabled||(p.action(),k())},children:[p.icon&&$("span",{className:"context-menu-icon",children:p.icon}),$("span",{className:"context-menu-label",children:p.label})]},p.id||x))})]})},m.id||c))}):null}import{useState as he,useCallback as R}from"react";function Z(w={}){let[S,j]=he({isVisible:!1,x:0,y:0}),h=R((c,p,x,f)=>{j({isVisible:!0,x:c,y:p,targetData:x,targetElement:f})},[]),k=R(()=>{j(c=>({...c,isVisible:!1}))},[]),C=R(c=>{try{let x={id:`highlight-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:`Highlight: ${c.text?.substring(0,30)}...`||"Unnamed Highlight",type:"highlight",parentId:"default-highlight",metadata:{description:"Created from context menu",tags:c.tags||[],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),data:{text:c.text,sourceType:c.sourceType,timestamp:c.timestamp,scriptId:c.scriptId,moduleId:c.moduleId,additionalData:c.data}}};if(w.onCreateHighlight)w.onCreateHighlight(c);else{let f=localStorage.getItem("allog-save-system"),N=f?JSON.parse(f):{items:[]};N.items.push(x),localStorage.setItem("allog-save-system",JSON.stringify(N)),console.log("Highlight created and saved:",x.name)}return c}catch(p){return console.error("Failed to create highlight:",p),c}},[w.onCreateHighlight]),m=R(c=>({id:"highlight",label:"Highlight",icon:"\u{1F4A1}",action:()=>C(c)}),[C]);return{contextMenu:S,showContextMenu:h,hideContextMenu:k,createHighlight:C,createHighlightMenuItem:m}}import{useState as _,useEffect as xe,useCallback as X}from"react";function ee(){let[w,S]=_([]),[j,h]=_(new Map);xe(()=>{let c=()=>{try{let f=localStorage.getItem("allog-save-system");if(f){let O=(JSON.parse(f).items?.filter(v=>v.type?.startsWith("highlight-")&&v.metadata?.highlightData)||[]).map(v=>({id:v.id,name:v.name,scriptId:v.metadata.highlightData.scriptId,moduleId:v.metadata.highlightData.moduleId,methodId:v.metadata.highlightData.methodId,valueId:v.metadata.highlightData.valueId,color:v.metadata.highlightData.color||"#ffff00",pattern:v.metadata.highlightData.pattern||"default",target:v.metadata.target||v.name||""}));S(O)}}catch{}};c();let p=f=>{f.key==="allog-save-system"&&c()};window.addEventListener("storage",p);let x=()=>{c()};return window.addEventListener("highlight-updated",x),()=>{window.removeEventListener("storage",p),window.removeEventListener("highlight-updated",x)}},[]);let k=X((c,p,x,f,N)=>w.find(b=>{if(b.scriptId&&p&&!p.includes(b.scriptId)||b.moduleId&&x&&!x.includes(b.moduleId)||b.valueId&&f&&!f.includes(b.valueId))return!1;if(c==="log"&&b.target&&N)return N.toLowerCase().includes(b.target.toLowerCase());if(f&&b.target)return f.toLowerCase().includes(b.target.toLowerCase());if(b.target){if(c==="log"&&N)return N.toLowerCase().includes(b.target.toLowerCase());if(f)return f.toLowerCase().includes(b.target.toLowerCase())}return!1})||null,[w]),C=X((c,p,x,f,N)=>{let b=k(c,p,x,f,N);if(!b)return{className:"",style:{},isHighlighted:!1};let O=`highlight-pattern-${b.pattern}`;return{className:`${c==="log"?"log-entry":c==="variable"||c==="state"||c==="function"||c==="property"||c==="event"?"monitoring-data-item":""} highlighted ${O}`,style:{"--highlight-color":b.color},isHighlighted:!0,highlight:b,dataAttributes:{"data-highlight-name":b.name}}},[k]),m=X(c=>{S(c)},[]);return{highlights:w,getHighlightForElement:k,getHighlightStyles:C,updateHighlights:m,isElementHighlighted:k}}import{jsx as a,jsxs as o}from"react/jsx-runtime";function we({onStatsUpdate:w,onConnectionUpdate:S,saveSystemRef:j}){let{contextMenu:h,showContextMenu:k,hideContextMenu:C}=Z(),{getHighlightStyles:m,isElementHighlighted:c}=ee(),p=ke(new Map),[x,f]=I({}),[N,b]=I({totalModules:0,totalScripts:0,totalVariables:0,totalStates:0,totalFunctions:0,totalProperties:0,totalEvents:0,lastUpdate:new Date().toISOString()}),[O,v]=I({isConnected:!1,retryCount:0}),[q,Ne]=I(!0),[W,Ce]=I(500),[d,z]=I({moduleId:"",scriptId:"",type:"",search:"",showVariables:!0,showStates:!0,showFunctions:!0,showProperties:!0,showEvents:!0}),[A,ae]=I(new Set),[D,ne]=I(new Set),[l,H]=I(null),[V,J]=I("table"),[y,oe]=I(null),U=ve(async()=>{try{let t=await fetch("/api/monitoring");if(t.ok){let e=await t.json();f(e.modules||{});let i=e.stats||N;b(i);let n={...O,isConnected:!0,error:void 0};if(v(n),w?.(i),S?.(n),l){let r=e.modules?.[l.moduleId];if(r){let s=r.scripts?.[l.scriptId];if(s){let u=s[l.type+"s"];u&&u[l.name]||H(null)}else H(null)}else H(null)}}}catch(t){console.error("Failed to fetch monitoring data:",t);let e={...O,isConnected:!1,error:"Connection failed",retryCount:O.retryCount+1};v(e),S?.(e)}},[N,l]);te(()=>{if(!q)return;let t=setInterval(U,W);return()=>clearInterval(t)},[q,W,U]),te(()=>{U()},[U]);let Y=ye(()=>{let t={};return!x||typeof x!="object"||Object.entries(x).forEach(([e,i])=>{if(d.moduleId&&!e.includes(d.moduleId)||!i||!i.scripts||typeof i.scripts!="object")return;let n={};Object.entries(i.scripts).forEach(([r,s])=>{if(d.scriptId&&!r.includes(d.scriptId)||!s||typeof s!="object")return;let u={variables:{},states:{},functions:{},properties:{},events:{},lastUpdate:s.lastUpdate||Date.now()};d.showVariables&&s.variables&&typeof s.variables=="object"&&Object.entries(s.variables).forEach(([g,M])=>{d.search&&!g.toLowerCase().includes(d.search.toLowerCase())||(u.variables[g]=M)}),d.showStates&&s.states&&typeof s.states=="object"&&Object.entries(s.states).forEach(([g,M])=>{d.search&&!g.toLowerCase().includes(d.search.toLowerCase())||(u.states[g]=M)}),d.showFunctions&&s.functions&&typeof s.functions=="object"&&Object.entries(s.functions).forEach(([g,M])=>{d.search&&!g.toLowerCase().includes(d.search.toLowerCase())||(u.functions[g]=M)}),d.showProperties&&s.properties&&typeof s.properties=="object"&&Object.entries(s.properties).forEach(([g,M])=>{d.search&&!g.toLowerCase().includes(d.search.toLowerCase())||(u.properties[g]=M)}),d.showEvents&&s.events&&typeof s.events=="object"&&Object.entries(s.events).forEach(([g,M])=>{d.search&&!g.toLowerCase().includes(d.search.toLowerCase())||(u.events[g]=M)}),Object.values(u).some(g=>typeof g=="object"&&Object.keys(g).length>0)&&(n[r]=u)}),Object.keys(n).length>0&&(t[e]={...i,scripts:n})}),t},[x,d]),ie=t=>{let e=new Set(A);e.has(t)?e.delete(t):e.add(t),ae(e)},re=t=>{let e=new Set(D);e.has(t)?e.delete(t):e.add(t),ne(e)},E=t=>{if(t===null)return"null";if(t===void 0)return"undefined";if(typeof t=="object")try{return JSON.stringify(t,null,2)}catch{return"[Complex Object]"}return String(t)},T=t=>t===null?"null":t===void 0?"undefined":Array.isArray(t)?"array":typeof t,G=t=>{let i=Date.now()-t;return i<1e3?"just now":i<6e4?`${Math.floor(i/1e3)}s ago`:i<36e5?`${Math.floor(i/6e4)}m ago`:`${Math.floor(i/36e5)}h ago`},L=t=>{let e="asc";y&&y.key===t&&y.direction==="asc"&&(e="desc"),oe({key:t,direction:e})},se=t=>y?[...t].sort((e,i)=>{let n,r;switch(y.key){case"moduleId":n=e.moduleId.toLowerCase(),r=i.moduleId.toLowerCase();break;case"scriptId":n=e.scriptId.toLowerCase(),r=i.scriptId.toLowerCase();break;case"name":n=e.name.toLowerCase(),r=i.name.toLowerCase();break;case"type":n=e.type.toLowerCase(),r=i.type.toLowerCase();break;case"value":n=E(e.value).toLowerCase(),r=E(i.value).toLowerCase();break;case"timestamp":n=e.timestamp,r=i.timestamp;break;default:return 0}return n<r?y.direction==="asc"?-1:1:n>r?y.direction==="asc"?1:-1:0}):t,F=t=>!y||y.key!==t?"\u2195\uFE0F":y.direction==="asc"?"\u2191":"\u2193",le=()=>{if(!l)return;let t={basicInformation:{name:l.name,type:l.type,timestamp:new Date(l.timestamp).toLocaleString(),moduleId:l.moduleId,scriptId:l.scriptId},valueInformation:{currentValue:l.value,previousValue:l.previousValue,valueType:T(l.value)},metadata:l.metadata||{}},e=JSON.stringify(t,null,2);navigator.clipboard.writeText(e).then(()=>{}).catch(i=>{})},ce=(t,e)=>{t.preventDefault();let i=`${e.moduleId}-${e.scriptId}-${e.name}`,n=p.current.get(i),r=Date.now();if(n&&r-n.lastClick<300){n.timeout&&clearTimeout(n.timeout),p.current.delete(i);return}let s=setTimeout(()=>{p.current.delete(i)},300);p.current.set(i,{lastClick:r,timeout:s}),k(t.clientX,t.clientY,{id:"monitoring-data",label:`Data: ${e.name}`,icon:"\u{1F4CA}",action:()=>{}})},de=(t,e)=>{t.preventDefault();let i=`table-row-${e.moduleId}-${e.scriptId}-${e.name}`,n=p.current.get(i),r=Date.now();if(n&&r-n.lastClick<300){n.timeout&&clearTimeout(n.timeout),p.current.delete(i);return}let s=setTimeout(()=>{p.current.delete(i)},300);p.current.set(i,{lastClick:r,timeout:s}),k(t.clientX,t.clientY,{id:"table-row",label:`Row: ${e.name}`,icon:"\u{1F4CB}",action:()=>{}})},P=(t,e)=>{let i=m(t.type,t.scriptId,t.moduleId,t.name);return o("div",{className:`monitoring-data-item monitoring-data-${t.type} ${i.className}`,style:i.style,onClick:()=>H(t),onContextMenu:n=>ce(n,t),...i.dataAttributes,children:[o("div",{className:"data-header",children:[a("span",{className:"data-name",children:t.name}),a("span",{className:`data-type data-type-${t.type}`,children:t.type}),a("span",{className:"data-time",children:G(t.timestamp)})]}),o("div",{className:"data-content",children:[o("div",{className:"data-value",children:[a("span",{className:"value-label",children:"Value:"}),a("span",{className:`value-content value-${T(t.value)}`,children:E(t.value)})]}),t.previousValue!==void 0&&o("div",{className:"data-previous",children:[a("span",{className:"value-label",children:"Previous:"}),a("span",{className:`value-content value-${T(t.previousValue)}`,children:E(t.previousValue)})]}),t.metadata&&o("div",{className:"data-metadata",children:[t.metadata.file&&o("span",{className:"metadata-item",children:["\u{1F4C1} ",t.metadata.file,":",t.metadata.line]}),t.metadata.functionName&&o("span",{className:"metadata-item",children:["\u{1F527} ",t.metadata.functionName]}),t.metadata.duration&&o("span",{className:"metadata-item",children:["\u23F1\uFE0F ",t.metadata.duration,"ms"]})]})]})]},e)},pe=()=>a("div",{className:"monitoring-tree",children:Object.entries(Y).map(([t,e])=>o("div",{className:"module-container",children:[o("div",{className:"module-header",onClick:()=>ie(t),children:[a("span",{className:"expand-icon",children:A.has(t)?"\u25BC":"\u25B6"}),a("span",{className:"module-name",children:t}),o("span",{className:"module-stats",children:[Object.keys(e.scripts).length," scripts"]})]}),A.has(t)&&a("div",{className:"module-content",children:Object.entries(e.scripts).map(([i,n])=>o("div",{className:"script-container",children:[o("div",{className:"script-header",onClick:()=>re(i),children:[a("span",{className:"expand-icon",children:D.has(i)?"\u25BC":"\u25B6"}),a("span",{className:"script-name",children:i}),o("span",{className:"script-stats",children:[(n.variables?Object.keys(n.variables).length:0)+(n.states?Object.keys(n.states).length:0)+(n.functions?Object.keys(n.functions).length:0)+(n.properties?Object.keys(n.properties).length:0)+(n.events?Object.keys(n.events).length:0)," items"]})]}),D.has(i)&&o("div",{className:"script-content",children:[d.showVariables&&n.variables&&Object.keys(n.variables).length>0&&o("div",{className:"data-category",children:[a("h4",{children:"Variables"}),Object.entries(n.variables).map(([r,s])=>P(s,`var-${i}-${r}`))]}),d.showStates&&n.states&&Object.keys(n.states).length>0&&o("div",{className:"data-category",children:[a("h4",{children:"States"}),Object.entries(n.states).map(([r,s])=>P(s,`state-${i}-${r}`))]}),d.showFunctions&&n.functions&&Object.keys(n.functions).length>0&&o("div",{className:"data-category",children:[a("h4",{children:"Functions"}),Object.entries(n.functions).map(([r,s])=>P(s,`func-${i}-${r}`))]}),d.showProperties&&n.properties&&Object.keys(n.properties).length>0&&o("div",{className:"data-category",children:[a("h4",{children:"Properties"}),Object.entries(n.properties).map(([r,s])=>P(s,`prop-${i}-${r}`))]}),d.showEvents&&n.events&&Object.keys(n.events).length>0&&o("div",{className:"data-category",children:[a("h4",{children:"Events"}),Object.entries(n.events).map(([r,s])=>P(s,`event-${i}-${r}`))]})]})]},i))})]},t))}),me=()=>{let t=[];return Object.entries(Y).forEach(([e,i])=>{!i||!i.scripts||Object.entries(i.scripts).forEach(([n,r])=>{!r||typeof r!="object"||Object.entries(r).forEach(([s,u])=>{s!=="lastUpdate"&&u&&typeof u=="object"&&Object.entries(u).forEach(([K,g])=>{if(g&&typeof g=="object"&&"value"in g){let M=s.slice(0,-1);t.push({moduleId:e,scriptId:n,name:K,type:M,value:g.value,timestamp:g.timestamp||Date.now(),metadata:g.metadata})}})})})}),a("div",{className:"monitoring-table",children:o("table",{children:[a("thead",{children:o("tr",{children:[o("th",{className:`sortable ${y?.key==="moduleId"?"sorted":""}`,onClick:()=>L("moduleId"),children:["Module",a("span",{className:"sort-indicator",children:F("moduleId")})]}),o("th",{className:`sortable ${y?.key==="scriptId"?"sorted":""}`,onClick:()=>L("scriptId"),children:["Script",a("span",{className:"sort-indicator",children:F("scriptId")})]}),o("th",{className:`sortable ${y?.key==="name"?"sorted":""}`,onClick:()=>L("name"),children:["Name",a("span",{className:"sort-indicator",children:F("name")})]}),o("th",{className:`sortable ${y?.key==="type"?"sorted":""}`,onClick:()=>L("type"),children:["Type",a("span",{className:"sort-indicator",children:F("type")})]}),o("th",{className:`sortable ${y?.key==="value"?"sorted":""}`,onClick:()=>L("value"),children:["Value",a("span",{className:"sort-indicator",children:F("value")})]}),a("th",{children:"Context"}),o("th",{className:`sortable ${y?.key==="timestamp"?"sorted":""}`,onClick:()=>L("timestamp"),children:["Time",a("span",{className:"sort-indicator",children:F("timestamp")})]})]})}),a("tbody",{children:se(t).map((e,i)=>{let n=m(e.type,e.scriptId,e.moduleId,e.name);return o("tr",{className:`table-row table-row-${e.type} ${n.className}`,style:n.style,onClick:()=>H({moduleId:e.moduleId,scriptId:e.scriptId,name:e.name,type:e.type,value:e.value,timestamp:e.timestamp}),onContextMenu:r=>de(r,e),...n.dataAttributes,children:[a("td",{className:"table-module",children:e.moduleId}),a("td",{className:"table-script",children:e.scriptId}),a("td",{className:"table-name",children:e.name}),a("td",{children:a("span",{className:`table-type table-type-${e.type}`,children:e.type})}),a("td",{className:"table-value",children:E(e.value)}),a("td",{className:"table-context",children:e.metadata&&o("div",{className:"context-info",children:[e.metadata.file&&o("span",{className:"context-file",title:`File: ${e.metadata.file}:${e.metadata.line||""}`,children:["\u{1F4C1} ",e.metadata.file.split("/").pop(),":",e.metadata.line]}),e.metadata.functionName&&o("span",{className:"context-function",title:`Function: ${e.metadata.functionName}`,children:["\u{1F527} ",e.metadata.functionName]}),e.metadata.duration&&o("span",{className:"context-duration",title:`Duration: ${e.metadata.duration}ms`,children:["\u23F1\uFE0F ",e.metadata.duration,"ms"]})]})}),a("td",{className:"table-time",children:G(e.timestamp)})]},`${e.moduleId}-${e.scriptId}-${e.name}-${i}`)})})]})})},ue=()=>{let t=[];return Object.entries(Y).forEach(([e,i])=>{!i||!i.scripts||Object.entries(i.scripts).forEach(([n,r])=>{!r||typeof r!="object"||(r.variables&&typeof r.variables=="object"&&Object.entries(r.variables).forEach(([s,u])=>t.push({moduleId:e,scriptId:n,data:u})),r.states&&typeof r.states=="object"&&Object.entries(r.states).forEach(([s,u])=>t.push({moduleId:e,scriptId:n,data:u})),r.functions&&typeof r.functions=="object"&&Object.entries(r.functions).forEach(([s,u])=>t.push({moduleId:e,scriptId:n,data:u})),r.properties&&typeof r.properties=="object"&&Object.entries(r.properties).forEach(([s,u])=>t.push({moduleId:e,scriptId:n,data:u})),r.events&&typeof r.events=="object"&&Object.entries(r.events).forEach(([s,u])=>t.push({moduleId:e,scriptId:n,data:u})))})}),t.sort((e,i)=>i.data.timestamp-e.data.timestamp),a("div",{className:"monitoring-timeline",children:t.map((e,i)=>{let n=m(e.data.type,e.data.scriptId,e.data.moduleId,e.data.name);return o("div",{className:`timeline-item timeline-${e.data.type} ${n.className}`,style:n.style,onClick:()=>H(e.data),...n.dataAttributes,children:[a("div",{className:"timeline-time",children:new Date(e.data.timestamp).toLocaleTimeString()}),o("div",{className:"timeline-content",children:[o("div",{className:"timeline-header",children:[a("span",{className:"timeline-module",children:e.moduleId}),a("span",{className:"timeline-script",children:e.scriptId}),a("span",{className:"timeline-name",children:e.data.name}),a("span",{className:`timeline-type timeline-type-${e.data.type}`,children:e.data.type})]}),a("div",{className:"timeline-value",children:E(e.data.value)})]})]},i)})})};return o("div",{className:"monitoring-page",children:[o("div",{className:"monitoring-filters",children:[o("div",{className:"filter-group",children:[a("input",{type:"text",placeholder:"Filter by module...",value:d.moduleId,onChange:t=>z(e=>({...e,moduleId:t.target.value})),className:"filter-input"}),a("input",{type:"text",placeholder:"Filter by script...",value:d.scriptId,onChange:t=>z(e=>({...e,scriptId:t.target.value})),className:"filter-input"}),a("input",{type:"text",placeholder:"Search...",value:d.search,onChange:t=>z(e=>({...e,search:t.target.value})),className:"filter-input"})]}),o("div",{className:"filter-group",children:[o("label",{children:[a("input",{type:"checkbox",checked:d.showVariables,onChange:t=>z(e=>({...e,showVariables:t.target.checked}))}),"Variables"]}),o("label",{children:[a("input",{type:"checkbox",checked:d.showStates,onChange:t=>z(e=>({...e,showStates:t.target.checked}))}),"States"]}),o("label",{children:[a("input",{type:"checkbox",checked:d.showFunctions,onChange:t=>z(e=>({...e,showFunctions:t.target.checked}))}),"Functions"]}),o("label",{children:[a("input",{type:"checkbox",checked:d.showProperties,onChange:t=>z(e=>({...e,showProperties:t.target.checked}))}),"Properties"]}),o("label",{children:[a("input",{type:"checkbox",checked:d.showEvents,onChange:t=>z(e=>({...e,showEvents:t.target.checked}))}),"Events"]})]}),o("div",{className:"view-mode-controls",children:[a("button",{className:`view-mode-btn ${V==="tree"?"active":""}`,onClick:()=>J("tree"),children:"Tree"}),a("button",{className:`view-mode-btn ${V==="table"?"active":""}`,onClick:()=>J("table"),children:"Table"}),a("button",{className:`view-mode-btn ${V==="timeline"?"active":""}`,onClick:()=>J("timeline"),children:"Timeline"})]})]}),o("div",{className:"monitoring-content",children:[o("div",{className:"monitoring-main",children:[V==="tree"&&pe(),V==="table"&&me(),V==="timeline"&&ue()]}),l&&o("div",{className:"monitoring-detail",children:[o("div",{className:"detail-header",children:[a("h3",{children:"Data Details"}),o("div",{className:"detail-header-controls",children:[a("button",{className:"copy-btn",onClick:le,title:"Copy data to clipboard",children:"\u{1F4CB} Copy"}),a("button",{className:"close-btn",onClick:()=>H(null),children:"\xD7"})]})]}),o("div",{className:"detail-content",children:[o("div",{className:"detail-section",children:[a("h4",{children:"Basic Information"}),o("div",{className:"detail-item",children:[a("span",{className:"detail-label",children:"Name:"}),a("span",{className:"detail-value",children:l.name})]}),o("div",{className:"detail-item",children:[a("span",{className:"detail-label",children:"Type:"}),a("span",{className:`detail-value detail-type-${l.type}`,children:l.type})]}),o("div",{className:"detail-item",children:[a("span",{className:"detail-label",children:"Timestamp:"}),a("span",{className:"detail-value",children:new Date(l.timestamp).toLocaleString()})]})]}),o("div",{className:"detail-section",children:[a("h4",{children:"Value Information"}),o("div",{className:"detail-item",children:[a("span",{className:"detail-label",children:"Current Value:"}),a("div",{className:"detail-value-container",children:a("span",{className:`detail-value detail-value-${T(l.value)}`,children:E(l.value)})})]}),l.previousValue!==void 0&&o("div",{className:"detail-item",children:[a("span",{className:"detail-label",children:"Previous Value:"}),a("div",{className:"detail-value-container",children:a("span",{className:`detail-value detail-value-${T(l.previousValue)}`,children:E(l.previousValue)})})]})]}),l.metadata&&o("div",{className:"detail-section",children:[a("h4",{children:"Metadata"}),l.metadata.file&&o("div",{className:"detail-item",children:[a("span",{className:"detail-label",children:"File:"}),o("span",{className:"detail-value",children:[l.metadata.file,":",l.metadata.line]})]}),l.metadata.functionName&&o("div",{className:"detail-item",children:[a("span",{className:"detail-label",children:"Function:"}),a("span",{className:"detail-value",children:l.metadata.functionName})]}),l.metadata.duration&&o("div",{className:"detail-item",children:[a("span",{className:"detail-label",children:"Duration:"}),o("span",{className:"detail-value",children:[l.metadata.duration,"ms"]})]}),l.metadata.error&&o("div",{className:"detail-item",children:[a("span",{className:"detail-label",children:"Error:"}),a("span",{className:"detail-value detail-error",children:l.metadata.error})]}),l.metadata.stack&&o("div",{className:"detail-item",children:[a("span",{className:"detail-label",children:"Stack:"}),a("pre",{className:"detail-stack",children:l.metadata.stack})]})]})]})]},`${l.moduleId}-${l.scriptId}-${l.name}-${l.timestamp}`)]}),a(B,{isVisible:h.isVisible,x:h.x,y:h.y,items:(()=>{let t=h.targetData?c(h.targetData.data?.type||"variable",h.targetData.scriptId,h.targetData.moduleId,h.targetData.data?.name):null;return[{id:"highlight",label:t?"Remove Highlight":"Highlight",icon:t?"\u274C":"\u{1F4A1}",action:()=>{h.targetData&&j?.current&&(t?j.current.removeHighlightForElement({elementType:h.targetData.data?.type||"variable",scriptId:h.targetData.scriptId,moduleId:h.targetData.moduleId,name:h.targetData.data?.name}):j.current.createHighlightFromData(h.targetData))}}]})(),onClose:C})]})}export{we as default};
