import{useState as u,useCallback as a}from"react";function x(s={}){let[l,r]=u({isVisible:!1,x:0,y:0}),c=a((t,e,n,i)=>{r({isVisible:!0,x:t,y:e,targetData:n,targetElement:i})},[]),m=a(()=>{r(t=>({...t,isVisible:!1}))},[]),o=a(t=>{try{let n={id:`highlight-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:`Highlight: ${t.text?.substring(0,30)}...`||"Unnamed Highlight",type:"highlight",parentId:"default-highlight",metadata:{description:"Created from context menu",tags:t.tags||[],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),data:{text:t.text,sourceType:t.sourceType,timestamp:t.timestamp,scriptId:t.scriptId,moduleId:t.moduleId,additionalData:t.data}}};if(s.onCreateHighlight)s.onCreateHighlight(t);else{let i=localStorage.getItem("allog-save-system"),g=i?JSON.parse(i):{items:[]};g.items.push(n),localStorage.setItem("allog-save-system",JSON.stringify(g)),console.log("Highlight created and saved:",n.name)}return t}catch(e){return console.error("Failed to create highlight:",e),t}},[s.onCreateHighlight]),d=a(t=>({id:"highlight",label:"Highlight",icon:"\u{1F4A1}",action:()=>o(t)}),[o]);return{contextMenu:l,showContextMenu:c,hideContextMenu:m,createHighlight:o,createHighlightMenuItem:d}}export{x as useContextMenu};
